// File: .devcontainer/devcontainer.json
{
    "name": "Multimax Frontend (Astro + React)",
    "dockerComposeFile": "docker-compose.yml",
    "service": "app",
    "workspaceFolder": "/workspaces/project-root",
    // Sincroniza permisos Linux <-> Host
    "remoteUser": "node",
    "updateRemoteUserUID": true,
    "customizations": {
        "vscode": {
            "settings": {
                // 1. REGLA GENERAL: Biome manda
                "editor.defaultFormatter": "biomejs.biome",
                "editor.formatOnSave": true,
                // 2. EXCEPCIÓN CRÍTICA: Archivos .astro
                // Esto impide que VS Code intente usar Biome para formatear Astro
                "[astro]": {
                    "editor.defaultFormatter": "astro-build.astro-vscode",
                    "editor.formatOnSave": true
                },
                // 3. REGLAS ESPECÍFICAS PARA JS/TS (React)
                "[javascript]": {
                    "editor.defaultFormatter": "biomejs.biome"
                },
                "[typescript]": {
                    "editor.defaultFormatter": "biomejs.biome"
                },
                "[typescriptreact]": {
                    "editor.defaultFormatter": "biomejs.biome"
                },
                "[json]": {
                    "editor.defaultFormatter": "biomejs.biome"
                },
                // 4. ACCIONES AL GUARDAR (Organizar Imports)
                // Configuramos esto SOLO para lenguajes que Biome entiende bien
                "editor.codeActionsOnSave": {
                    "source.organizeImports.biome": "explicit",
                    "source.fixAll.biome": "explicit"
                },
                // 5. TAILWIND & CSS
                "files.associations": {
                    "*.css": "tailwindcss"
                },
                "editor.quickSuggestions": {
                    "strings": true
                }
            },
            "extensions": [
                // CORE FRAMEWORK
                "astro-build.astro-vscode", // IMPRESCINDIBLE para Astro
                "biomejs.biome", // Linter/Formatter Ultra-rápido
                "bradlc.vscode-tailwindcss", // CSS Intelligence
                // UTILIDADES EQUIPO
                "rangav.vscode-thunder-client", // Pruebas de API (Astro Actions)
                "eamodio.gitlens", // Historial Git
                "christian-kohler.path-intellisense",
                "adpyke.codesnap", // Screenshots para documentación
                // --- EXTRAS VISUALES ---
                "adpyke.codesnap", // Screenshots bonitos
                "jmkrivocapich.drawfolderstructure", // Generador de árboles de carpetas
                "kisstkondoros.vscode-gutter-preview", // Ver imágenes en miniatura en el editor
                "shd101wyy.markdown-preview-enhanced" // Previsualización Markdown Pro
            ]
        }
    },
    // COMANDOS DE INICIO
    // 1. Configura git safe directory (evita error de dubious ownership)
    // 2. Instala dependencias automáticamente al crear el contenedor
    "postCreateCommand": "git config --global --add safe.directory /workspaces/project-root && pnpm install",
    // Optimización para Vite/Astro Hot Reload en Docker
    "containerEnv": {
        "CHOKIDAR_USEPOLLING": "true"
    }
}